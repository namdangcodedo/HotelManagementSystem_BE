### Test Booking vá»›i Holiday Pricing
### Author: Hotel Management Team
### Date: 2025-01-19

### Variables
@baseUrl = http://localhost:8080
@apiUrl = {{baseUrl}}/api

### 1. ÄÄƒng nháº­p Ä‘á»ƒ láº¥y token
POST {{apiUrl}}/authentication/login
Content-Type: application/json

{
  "username": "admin",
  "password": "Admin@123"
}

### Save access token from response
### Sá»­ dá»¥ng: Authorization: Bearer {{access_token}}

### 2. Kiá»ƒm tra danh sÃ¡ch CommonCode - RoomStatus
GET {{apiUrl}}/commoncode/type/RoomStatus
Content-Type: application/json

### 3. Kiá»ƒm tra danh sÃ¡ch CommonCode - PaymentStatus
GET {{apiUrl}}/commoncode/type/PaymentStatus
Content-Type: application/json

### 4. Kiá»ƒm tra danh sÃ¡ch CommonCode - BookingType
GET {{apiUrl}}/commoncode/type/BookingType
Content-Type: application/json

### 5. Kiá»ƒm tra thÃ´ng tin phÃ²ng 101
GET {{apiUrl}}/room/1
Content-Type: application/json

### 6. Kiá»ƒm tra thÃ´ng tin phÃ²ng 201
GET {{apiUrl}}/room/3
Content-Type: application/json

### ============================================
### TEST CASE 1: Booking ngÃ y thÆ°á»ng (khÃ´ng cÃ³ holiday pricing)
### ============================================

### 7. Kiá»ƒm tra phÃ²ng available trong ngÃ y thÆ°á»ng
POST {{apiUrl}}/booking/check-availability
Content-Type: application/json
Authorization: Bearer {{access_token}}

{
  "roomIds": [1, 2],
  "checkInDate": "2025-03-15T14:00:00",
  "checkOutDate": "2025-03-17T12:00:00"
}

### 8. Táº¡o booking ngÃ y thÆ°á»ng
POST {{apiUrl}}/booking/create
Content-Type: application/json
Authorization: Bearer {{access_token}}

{
  "customerId": 1,
  "roomIds": [1, 2],
  "checkInDate": "2025-03-15T14:00:00",
  "checkOutDate": "2025-03-17T12:00:00",
  "bookingType": "Online",
  "specialRequests": "Test booking - ngÃ y thÆ°á»ng"
}

### Káº¿t quáº£ mong Ä‘á»£i:
### Room 101: 800,000 VNÄ/Ä‘Ãªm Ã— 2 Ä‘Ãªm = 1,600,000 VNÄ
### Room 102: 800,000 VNÄ/Ä‘Ãªm Ã— 2 Ä‘Ãªm = 1,600,000 VNÄ
### Tá»•ng: 3,200,000 VNÄ
### Deposit (30%): 960,000 VNÄ

### ============================================
### TEST CASE 2: Booking dá»‹p Táº¿t NguyÃªn ÄÃ¡n (28/01 - 03/02/2025)
### ============================================

### 9. Kiá»ƒm tra Holiday Pricing cho Táº¿t
GET {{apiUrl}}/holiday/1
Content-Type: application/json
Authorization: Bearer {{access_token}}

### 10. Kiá»ƒm tra phÃ²ng available trong dá»‹p Táº¿t
POST {{apiUrl}}/booking/check-availability
Content-Type: application/json
Authorization: Bearer {{access_token}}

{
  "roomIds": [1, 3],
  "checkInDate": "2025-01-28T14:00:00",
  "checkOutDate": "2025-01-30T12:00:00"
}

### 11. Táº¡o booking trong dá»‹p Táº¿t
POST {{apiUrl}}/booking/create
Content-Type: application/json
Authorization: Bearer {{access_token}}

{
  "customerId": 1,
  "roomIds": [1, 3],
  "checkInDate": "2025-01-28T14:00:00",
  "checkOutDate": "2025-01-30T12:00:00",
  "bookingType": "Online",
  "specialRequests": "Test booking - dá»‹p Táº¿t"
}

### Káº¿t quáº£ mong Ä‘á»£i:
### Room 101: (800,000 + 300,000) VNÄ/Ä‘Ãªm Ã— 2 Ä‘Ãªm = 2,200,000 VNÄ
### Room 201: (1,500,000 + 500,000) VNÄ/Ä‘Ãªm Ã— 2 Ä‘Ãªm = 4,000,000 VNÄ
### Tá»•ng: 6,200,000 VNÄ
### Deposit (30%): 1,860,000 VNÄ

### ============================================
### TEST CASE 3: Booking lá»… 30/4 - 1/5 (30/04 - 03/05/2025)
### ============================================

### 12. Kiá»ƒm tra phÃ²ng available trong dá»‹p lá»… 30/4
POST {{apiUrl}}/booking/check-availability
Content-Type: application/json
Authorization: Bearer {{access_token}}

{
  "roomIds": [1, 2],
  "checkInDate": "2025-04-30T14:00:00",
  "checkOutDate": "2025-05-02T12:00:00"
}

### 13. Táº¡o booking trong dá»‹p lá»… 30/4
POST {{apiUrl}}/booking/create
Content-Type: application/json
Authorization: Bearer {{access_token}}

{
  "customerId": 1,
  "roomIds": [1, 2],
  "checkInDate": "2025-04-30T14:00:00",
  "checkOutDate": "2025-05-02T12:00:00",
  "bookingType": "Online",
  "specialRequests": "Test booking - dá»‹p lá»… 30/4"
}

### Káº¿t quáº£ mong Ä‘á»£i:
### Room 101: (800,000 + 200,000) VNÄ/Ä‘Ãªm Ã— 2 Ä‘Ãªm = 2,000,000 VNÄ
### Room 102: (800,000 + 200,000) VNÄ/Ä‘Ãªm Ã— 2 Ä‘Ãªm = 2,000,000 VNÄ
### Tá»•ng: 4,000,000 VNÄ
### Deposit (30%): 1,200,000 VNÄ

### ============================================
### TEST CASE 4: Booking Quá»‘c KhÃ¡nh 2/9 (01/09 - 03/09/2025)
### ============================================

### 14. Táº¡o booking trong dá»‹p Quá»‘c KhÃ¡nh
POST {{apiUrl}}/booking/create
Content-Type: application/json
Authorization: Bearer {{access_token}}

{
  "customerId": 1,
  "roomIds": [2, 3],
  "checkInDate": "2025-09-01T14:00:00",
  "checkOutDate": "2025-09-03T12:00:00",
  "bookingType": "Online",
  "specialRequests": "Test booking - dá»‹p Quá»‘c KhÃ¡nh"
}

### Káº¿t quáº£ mong Ä‘á»£i:
### Room 102: (800,000 + 200,000) VNÄ/Ä‘Ãªm Ã— 2 Ä‘Ãªm = 2,000,000 VNÄ
### Room 201: (1,500,000 + 300,000) VNÄ/Ä‘Ãªm Ã— 2 Ä‘Ãªm = 3,600,000 VNÄ
### Tá»•ng: 5,600,000 VNÄ
### Deposit (30%): 1,680,000 VNÄ

### ============================================
### TEST CASE 5: Booking span across holiday (má»™t pháº§n ngÃ y lá»…)
### ============================================

### 15. Táº¡o booking tá»« trÆ°á»›c Táº¿t Ä‘áº¿n trong Táº¿t
POST {{apiUrl}}/booking/create
Content-Type: application/json
Authorization: Bearer {{access_token}}

{
  "customerId": 1,
  "roomIds": [1],
  "checkInDate": "2025-01-27T14:00:00",
  "checkOutDate": "2025-01-30T12:00:00",
  "bookingType": "Online",
  "specialRequests": "Test booking - trÆ°á»›c vÃ  trong Táº¿t"
}

### Káº¿t quáº£ mong Ä‘á»£i:
### ÄÃªm 1 (27/01): 800,000 VNÄ (giÃ¡ thÆ°á»ng)
### ÄÃªm 2 (28/01): 1,100,000 VNÄ (giÃ¡ Táº¿t)
### ÄÃªm 3 (29/01): 1,100,000 VNÄ (giÃ¡ Táº¿t)
### Tá»•ng: 3,000,000 VNÄ
### Deposit (30%): 900,000 VNÄ

### ============================================
### VERIFY BOOKINGS
### ============================================

### 16. Láº¥y thÃ´ng tin booking vá»«a táº¡o
GET {{apiUrl}}/booking/{{bookingId}}
Content-Type: application/json
Authorization: Bearer {{access_token}}

### 17. Láº¥y danh sÃ¡ch booking cá»§a customer
GET {{apiUrl}}/booking/my-bookings
Content-Type: application/json
Authorization: Bearer {{access_token}}

### ============================================
### PAYMENT FLOW TEST
### ============================================

### 18. Confirm payment (sau khi thanh toÃ¡n qua PayOS)
POST {{apiUrl}}/booking/confirm-payment
Content-Type: application/json
Authorization: Bearer {{access_token}}

{
  "bookingId": 1,
  "orderCode": "250119143000"
}

### 19. Kiá»ƒm tra transaction
GET {{apiUrl}}/transaction/booking/{{bookingId}}
Content-Type: application/json
Authorization: Bearer {{access_token}}

### ============================================
### CANCEL BOOKING TEST
### ============================================

### 20. Cancel booking
POST {{apiUrl}}/booking/cancel/{{bookingId}}
Content-Type: application/json
Authorization: Bearer {{access_token}}

### ============================================
### NOTES & REMINDERS
### ============================================

### ğŸ“Œ LÆ¯U Ã QUAN TRá»ŒNG:
### 1. Táº¤T Cáº¢ Status vÃ  Type PHáº¢I láº¥y tá»« CommonCode
### 2. KhÃ´ng Ä‘Æ°á»£c hardcode ID cá»§a Status/Type
### 3. Sá»­ dá»¥ng CodeName Ä‘á»ƒ query CommonCode
### 4. Kiá»ƒm tra null trÆ°á»›c khi gÃ¡n giÃ¡ trá»‹

### ğŸ“‹ Danh sÃ¡ch CodeType cáº§n nhá»›:
### - RoomStatus: Available, Booked, Occupied, Cleaning, Maintenance
### - PaymentStatus: Paid, Unpaid, Refunded, PartiallyPaid
### - DepositStatus: Paid, Unpaid
### - BookingType: Online, Walkin
### - PaymentMethod: Cash, Card, Bank, EWallet

### ğŸ’¡ Holiday Pricing Rules:
### - GiÃ¡ ngÃ y lá»… = BasePriceNight + PriceAdjustment
### - TÃ­nh theo tá»«ng Ä‘Ãªm
### - Ãp dá»¥ng cho tá»«ng phÃ²ng cá»¥ thá»ƒ
### - Kiá»ƒm tra IsActive vÃ  ExpiredDate

### ğŸ§ª Test Checklist:
### [ ] Booking ngÃ y thÆ°á»ng
### [ ] Booking ngÃ y lá»… Táº¿t
### [ ] Booking ngÃ y lá»… 30/4
### [ ] Booking ngÃ y lá»… 2/9
### [ ] Booking span across holiday
### [ ] Check availability
### [ ] Payment confirmation
### [ ] Cancel booking
